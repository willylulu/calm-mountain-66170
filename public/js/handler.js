function sendMessage(e){sendMessageBody(e)}function keypress(e,t){13==e.keyCode&&sendMessageBody(t)}function t_sendMessage(e){sendMessageBodyOwnVideo(e)}function t_keypress(e,t){13==e.keyCode&&sendMessageBodyOwnVideo(t)}function sendMessageBody(e){var t=$("#text_"+e).val();socket.emit("/sendMessage",{id:e,message:t,userName:userName}),$("#text_"+e).val("")}function sendMessageBodyVideo(e){var t=$("#textVideo_"+e).val();$.post("/sendMessageVideo",{id:e,message:t,userName:userName},function(e){window.location.reload()}),$("#textVideo_"+e).val("")}function sendMessageBodyOwnVideo(e){var t=$("#textOwn_"+e).val();$.post("/sendMessageVideo",{id:e,message:t,userName:userName},function(e){window.location.reload()}),$("#textVideo_"+e).val("")}function postMessageOnPanel(e,t,n){$("#"+e+t).html("");for(var s in n){var o,i=n[s],a=document.createElement("div");"startStream"==i.status?o="alert-info":"Video"==i.status&&(o="alert-danger"),a.className="msg alert "+o,a.innerHTML=i.userName+" : "+i.message,a.style="display:inline-block;",$("#"+e+t).append(a);var u=document.createElement("br");$("#"+e+t).append(u)}}function imageUrlOnchange(){$("#imageDisplayByUrl")[0].src=$("#urlInput").val()}function showMessage(e){$.post("/getMessage",{id:e},function(t){postMessageOnPanel("message_Video",e,t)}),getYoutubeData(0,e)}function keypressVideo(e,t){13==e.keyCode&&sendMessageBodyVideo(t)}function getYoutubeData(e,t){$.post("/getYoutubeData",{id:t},function(n){useYoutubeData(e,t,n)})}function useYoutubeData(e,t,n){$("#myVideoName"+e+"_"+t).html(n.snippet.localized.title),$("#youtubeInfoTags"+e+"_"+t).html(""),$("#youtubeInfoAuthor"+e+"_"+t).html(n.snippet.channelTitle),$("#youtubeInfoPublish"+e+"_"+t).html(new Date(n.snippet.publishedAt)),$("#youtubeInfoView"+e+"_"+t).html(n.statistics.viewCount),$("#youtubeInfoLike"+e+"_"+t).html(n.statistics.likeCount),$("#youtubeInfoDislike"+e+"_"+t).html(n.statistics.dislikeCount);for(var s=0;s<n.snippet.tags.length;s++){var o=n.snippet.tags[s];$("#youtubeInfoTags"+e+"_"+t).append('<span class="badge">'+o+"</span>&nbsp;")}}function hideMessage(e){$("#message_Video"+e).html("<br/>"),$("#showMessageButton_"+e).html("Show Message")}function getOwnVideoMessage(e){$.post("/getMessage",{id:e},function(t){postMessageOnPanel("messageOwn_",e,t)})}function streamModalShowHendler(e){var t=$(this).attr("client-id");socket.emit("registerStream",{id:t})}function streamModalHideHendler(e){var t=$(this).attr("client-id");socket.emit("unregisterStream",{id:t})}function facebookLoginButtonHendler(){FB.login(function(e){post("/loginByFacebook",{userID:e.authResponse.userID,token:e.authResponse.accessToken})})}function uploadImageSubmitButtonHendler(){uploadLock||($.post("uploadImage",{data:imageDataUrl,type:$("#uploadImageSubmitButton").attr("value"),userID:userID},function(e){switch(alert(e),uploadLock=!1,$("#uploadImageSubmitButton").attr("value")){case"1":$("#uploadImageSubmitButton").html("Upload Face");break;case"2":$("#uploadImageSubmitButton").html("Upload Background");break;case"3":$("#uploadImageSubmitButton").html("Upload Picture")}window.location.reload()}),$("#uploadImageSubmitButton").html("Uploading..."),uploadLock=!0)}function deleteImageByUrlButtonHendler(){if(confirm("Sure to delete?")){var e=$(this).attr("value");$.post("/deleteImage",{userID:userID,url:e},function(e){window.location.reload()})}}function deleteDrag(e){e.dataTransfer.setData("Text",e.target.src)}function deleteDrop(e){e.preventDefault();var t=e.dataTransfer.getData("Text");confirm("Sure to delete?")&&$.post("/deleteImage",{userID:userID,url:t},function(e){window.location.reload()})}function allowDeleteDrop(e){e.preventDefault()}function changeOwnVideoPage(e){0==e?OwnVideoShowNum>9&&(hideVideoToken(OwnVideoShowNum),OwnVideoShowNum-=9,showVideoToken(OwnVideoShowNum)):OwnVideoShowNum<=ownVideoNum&&(hideVideoToken(OwnVideoShowNum),OwnVideoShowNum+=9,showVideoToken(OwnVideoShowNum))}function hideVideoToken(e){for(var t=OwnVideoShowNum-9;t<OwnVideoShowNum;t++)$("#ownVideoLink_"+t).hide()}function showVideoToken(e){for(var t=OwnVideoShowNum-9;t<OwnVideoShowNum;t++)$("#ownVideoLink_"+t).show()}function discussContentFocusHendler(){$("#discussInput").hide()}function discussInputHendler(e){if(13==e.which){var t=$("#discussInput").val(),n=document.createElement("div");switch($("#discussInput").attr("tagType")){case"0":var s=document.createElement("a");s.setAttribute("href",t),s.innerHTML=t,n.appendChild(s);break;case"1":var o=document.createElement("img");o.src=t,n.appendChild(o);break;case"2":var i=document.createElement("iframe");i.width=420,i.height=315;var a=t;a.includes("https://www.youtube.com/watch")?(a=a.substring(32),a="https://www.youtube.com/embed/"+a,a.indexOf("&")!=-1&&(a=a.substring(0,a.indexOf("&")))):a.includes("https://youtu.be/")&&(a=a.substring(17),a="https://www.youtube.com/embed/"+a,a.indexOf("?")!=-1&&(a=a.substring(0,a.indexOf("?")))),i.src=a,i.setAttribute("frameborder","0"),i.setAttribute("allowFullScreen",""),n.appendChild(i)}$("#discussContent").append(n),$("#discussInput").val("")}}function discussImageHendler(){$("#discussInput").show(),$("#discussInput").val(""),$("#discussInput").attr("placeholder","image url?"),$("#discussInput").attr("tagType","1")}function discussYoutubeHendler(){$("#discussInput").show(),$("#discussInput").val(""),$("#discussInput").attr("placeholder","youtube url?"),$("#discussInput").attr("tagType","2")}function discussLinkHendler(){$("#discussInput").show(),$("#discussInput").val(""),$("#discussInput").attr("placeholder","http://"),$("#discussInput").attr("tagType","0")}function discussSubmitHendler(){$("#selectPanel").remove();var e=$("#discussTitle").val(),t=$("#discussContent").html(),n=$("#discussAnony").prop("checked");""!=$("#discussInput").val()?confirm("something not inputed, still submit?")&&$.post("/discussInsert",{title:e,content:t,anony:n,userName:userName,userID:userID},function(e){alert(e),window.location.reload()}):$.post("/discussInsert",{title:e,content:t,anony:n,userName:userName,userID:userID},function(e){alert(e),window.location.reload()})}function selectPanelHendler(){if(window.getSelection){var e=window.getSelection(),t=e.toString();if(""!=t){var n=e.getRangeAt(0),s=n.getBoundingClientRect();if(0==$("#selectPanel").length){var o=document.createElement("div");o.id="selectPanel",o.className="well well-sm",o.innerHTML="<form class='form-inline'>The <input class='form-control' value='"+t+"' readonly > is :</form><br/>",o.contentEditable="false";var i=document.createElement("div");i.className="btn-group";var a=document.createElement("button");a.className="btn btn-info",a.innerHTML="Link";var u=document.createElement("button");u.className="btn btn-info",u.innerHTML="Image";var d=document.createElement("button");d.className="btn btn-info",d.innerHTML="Youtube",i.appendChild(a),i.appendChild(u),i.appendChild(d),o.appendChild(i),$("#discussContent").append(o),inter=setInterval(selectPanelClearer,100)}var c=$("#discussContent").offset(),l=s.top+s.height-c.top+150,r=s.left+s.width-c.left;$("#selectPanel").css("position","absolute"),$("#selectPanel").css("top",l+"px"),$("#selectPanel").css("left",r+"px"),a&&u&&d&&(a.onclick=selectIsLink,u.onclick=selectIsImage,d.onclick=selectIsYoutube)}else $("#selectPanel").remove()}}function selectIsYoutube(){var e=window.getSelection().toString(),t=window.getSelection().getRangeAt(0);t.deleteContents(),window.getSelection().removeAllRanges();var n=document.createElement("iframe");n.width=420,n.height=315,e.includes("https://www.youtube.com/watch")?(e=e.substring(32),e="https://www.youtube.com/embed/"+e,e.indexOf("&")!=-1&&(e=e.substring(0,e.indexOf("&")))):e.includes("https://youtu.be/")&&(e=e.substring(17),e="https://www.youtube.com/embed/"+e,e.indexOf("?")!=-1&&(e=e.substring(0,e.indexOf("?")))),n.src=e,n.setAttribute("frameborder","0"),n.setAttribute("allowFullScreen",""),t.insertNode(n),$("#selectPanel").remove()}function selectIsLink(){var e=window.getSelection().toString(),t=window.getSelection().getRangeAt(0);t.deleteContents(),window.getSelection().removeAllRanges();var n=document.createElement("a");n.href=e,n.innerHTML=e,t.insertNode(n),$("#selectPanel").remove()}function selectIsImage(){var e=window.getSelection().toString(),t=window.getSelection().getRangeAt(0);t.deleteContents(),window.getSelection().removeAllRanges();var n=document.createElement("img");n.src=e,t.insertNode(n),$("#selectPanel").remove()}function selectPanelClearer(){window.getSelection&&""==window.getSelection().toString()&&($("#selectPanel").remove(),clearInterval(inter))}function changeDiscussPage(e){"down"==e?page>0&&(page-=1):"up"==e&&(page+=1),switchDiscussPage(page)}function switchDiscussPage(e){0==$(".discussion").length?switchDiscussPageCont(e):$(".discussion").animateCss("bounceOutLeft",function(){switchDiscussPageCont(e)})}function switchDiscussPageCont(e){$(".discussion").remove(),htmlAction($("#discussAccordion"),"get","getDiscussions","discussPanel",{page:e},function(){htmlPartial($("#discussAccordion"),"discussAccordionJs"),$(".discussion").animateCss("bounceInRight",function(){})})}function changeVideoPage(e){"down"==e?videoPage>0&&(videoPage-=1):"up"==e&&(videoPage+=1),switchVideoPage(videoPage)}function switchVideoPage(e){0==$(".videoPanel").length?switchVideoPageCont(e):$("#videoBody").animateCss("zoomOut",function(){switchVideoPageCont(e)})}function switchVideoPageCont(e){$(".videoPanel").remove(),htmlAction($("#videoBody"),"get","getVideos","videoPanel",{page:e},function(){$("#videoBody").animateCss("zoomIn",function(){})})}function dragoverHandler(e){e.preventDefault()}function dropHandler(e){e.preventDefault();var t=e.dataTransfer.files;for(var n in t)if("image/jpeg"==t[n].type||"image/png"==t[n].type){var s=new FileReader;s.onload=function(e){var t=e.target.result,n=document.createElement("img");n.src=t,n.style="height:100%",document.getElementById("dropDIV").appendChild(n);var o=document.createElement("canvas"),i=o.getContext("2d");i.drawImage(n,0,0),console.log(s.result);var a=s.result.split(",");imageDataUrl=a[1]},s.readAsDataURL(t[n])}}$.fn.extend({animateCss:function(e,t){var n="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";$(this).addClass("animated "+e).one(n,function(){$(this).removeClass("animated "+e),t()})}});var uploadLock=!1,OwnVideoShowNum=9,inter,page=0,videoPage=0,imageDataUrl;